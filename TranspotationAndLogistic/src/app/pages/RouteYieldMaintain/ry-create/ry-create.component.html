<div class="page-wrapper">
  <header class="page-header">
    <h1>Create New Route Yield</h1>
  </header>

  <div class="page-container">
    <!-- Use the correct form group name: yieldForm -->
    <form [formGroup]="yieldForm" (ngSubmit)="submitForm()" class="route-form">
      <div class="form-container">

        <!-- This is now a dropdown to select an existing route -->
        <div class="form-group">
          <label for="rId">Route</label>
          <select id="rId" formControlName="rId"
            [attr.aria-invalid]="yieldForm.get('rId')?.invalid && yieldForm.get('rId')?.touched ? 'true' : null">
            <option [ngValue]="null" disabled>Select a Route</option>
            @for(route of routes; track route.rId) {
              <option [ngValue]="route.rId">{{ route.rName }}</option>
            }
          </select>
          @if (yieldForm.get('rId')?.invalid && yieldForm.get('rId')?.touched) {
            <div class="error">A route is required.</div>
          }
        </div>

        <!-- This form control name matches the new form -->
        <div class="form-group">
          <label for="collected_Yield">Collected Yield (Kg)</label>
          <input id="collected_Yield" formControlName="collected_Yield" type="number"
            [attr.aria-invalid]="yieldForm.get('collected_Yield')?.invalid && yieldForm.get('collected_Yield')?.touched ? 'true' : null" />
          @if (yieldForm.get('collected_Yield')?.invalid && yieldForm.get('collected_Yield')?.touched) {
            <div class="error">Collected Yield is required and must be a positive number.</div>
          }
        </div>

        <!-- This form control name matches the new form -->
        <div class="form-group">
          <label for="golden_Tips_Present">Golden Tips Present</label>
          <select id="golden_Tips_Present" formControlName="golden_Tips_Present"
            [attr.aria-invalid]="yieldForm.get('golden_Tips_Present')?.invalid && yieldForm.get('golden_Tips_Present')?.touched ? 'true' : null">
            <option value="" disabled>Select</option>
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
          @if (yieldForm.get('golden_Tips_Present')?.invalid && yieldForm.get('golden_Tips_Present')?.touched) {
            <div class="error">Please select an option.</div>
          }
        </div>

        <div class="form-actions">
          <!-- Disable button based on the correct form name -->
          <button type="submit" class="btn-primary" [disabled]="yieldForm.invalid">Submit</button>
        </div>

      </div>
    </form>
  </div>
</div>