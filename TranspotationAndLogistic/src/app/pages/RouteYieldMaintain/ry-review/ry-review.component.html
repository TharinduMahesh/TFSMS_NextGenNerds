<div class="route-container">
  <div class="top-bar">
    <input type="text" placeholder="Search..." [value]="searchTerm()"
      (input)="searchTerm.set($any($event.target).value)" />

    <button class="add-route" (click)="addNewRoute()">
      + Add New Yield
    </button>
  </div>

  @if (isLoading()) {
    <div class="loading">Loading...</div>
  } @else if (error()) {
    <div class="error">{{ error() }}</div>
  } @else {
    <div class="route-list">
      <table>
        <thead>
          <tr>
            <th>Yield ID</th>
            <th>Route Name</th>
            <th>Collected Yield (kg)</th>
            <th>Golden Tips</th>
            <th>Collector ID</th>
            <th>Vehicle ID</th>
            <th>Actions</th> <!-- Add an actions column -->
          </tr>
        </thead>
        <tbody>
          @for (route of filteredYieldLists(); track trackById($index, route)) {
          <tr>
            <td>{{ route.yId }}</td> <!-- Use the correct yield ID -->
            <td>{{ route.rName }}</td>
            <td>{{ route.collected_Yield }}</td>
            <td>{{ route.golden_Tips_Present }}</td>
            <td>{{ route.collectorID }}</td>
            <td>{{ route.vehicleID }}</td> <!-- Typo fixed: vehicalID -> vehicleID -->
            <td class="actions-cell">
              <button (click)="onView(route)" class="btn-action btn-view">View</button>
              <button (click)="onEdit(route)" class="btn-action btn-edit">Edit</button>
              <button (click)="onDelete(route.yId)" class="btn-action btn-delete">Delete</button>
            </td>
          </tr>
          } @empty {
          <tr>
            <td colspan="7">No yield records found.</td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  }

  <!-- View Modal -->
  @if (isViewModalOpen() && routeToView()) {
    <app-ryview [route]="routeToView()!" (close)="closeViewModal()"></app-ryview>
  }

  <!-- Edit Modal -->
  @if (isEditModalOpen() && routeToEdit()) {
    <app-ryedit [route]="routeToEdit()!" (close)="closeEditModal($event)"></app-ryedit>
  }
</div>